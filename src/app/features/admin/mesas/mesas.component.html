<div class="mesas-container">

  <h2>Gestión de Mesas</h2>

  <div class="form-card" *ngIf="esAdmin">
    <form (ngSubmit)="crearMesa()">
      <input
        type="number"
        placeholder="N° mesa"
        [(ngModel)]="nuevaMesa.numero"
        name="numero"
        required>

      <button type="submit">
        + Crear mesa
      </button>
    </form>
  </div>

  <div class="grid">
    <div class="mesa-card-wrapper" *ngFor="let mesa of mesas">

      <div
        class="mesa-card"
        [ngClass]="mesa.estado"
        (click)="abrirPedido(mesa)">
        <h3>Mesa {{ mesa.numero }}</h3>
        <span class="estado">{{ mesa.estado }}</span>
      </div>

      <!-- ACCIONES ADMIN -->
      <div class="mesa-admin" *ngIf="esAdmin">

        <button
          (click)="cambiarEstado(mesa,'LIBRE'); $event.stopPropagation()"
          [disabled]="mesa.estado === 'OCUPADA'">
          Libre
        </button>

        <button
          (click)="cambiarEstado(mesa,'OCUPADA'); $event.stopPropagation()">
          Ocupar
        </button>

        <button
          (click)="cambiarEstado(mesa,'RESERVADA'); $event.stopPropagation()">
          Reservar
        </button>

        <button
          class="btn-eliminar"
          (click)="eliminarMesa(mesa.id); $event.stopPropagation()"
          [disabled]="mesa.estado === 'OCUPADA'">
          Eliminar
        </button>

      </div>

    </div>
  </div>

</div>

<!-- MODAL PEDIDO -->
<div class="modal-backdrop" *ngIf="mesaSeleccionada && pedidoActivo">

  <div class="modal">

    <header class="modal-header">
      <h3>
        Mesa {{ mesaSeleccionada.numero }} –
        Pedido #{{ pedidoActivo.id }}
      </h3>

      <button
        class="btn-cerrar"
        (click)="cerrarModal()">
        ×
      </button>
    </header>

    <div class="modal-body">

      <!-- MENÚ -->
      <div class="menu">
        <h4>Menú</h4>

        <div class="menu-scroll">
          <div
            class="menu-item"
            *ngFor="let plato of platos"
            (click)="agregarPlato(plato)">
            <span>{{ plato.nombre }}</span>
            <strong>S/ {{ plato.precio }}</strong>
          </div>
        </div>
      </div>

      <!-- DETALLE PEDIDO -->
      <div class="detalle">
        <h4>Pedido</h4>

        <div
          class="detalle-scroll"
          *ngIf="itemsPedido.length > 0">

          <div
            class="item-ticket"
            *ngFor="let item of itemsPedido">

            <span>{{ item.menuItem.nombre }}</span>

            <div class="item-controls">
              <button (click)="quitarPlato(item.menuItem)">−</button>
              <span>{{ item.cantidad }}</span>
              <button (click)="agregarPlato(item.menuItem)">+</button>
            </div>

            <strong>
              S/ {{ item.precio * item.cantidad }}
            </strong>

          </div>
        </div>

        <div
          class="pedido-vacio"
          *ngIf="itemsPedido.length === 0">
          Pedido vacío
        </div>

      </div>

    </div>

    <footer class="modal-footer">
      <span>
        Total: S/ {{ pedidoActivo.total }}
      </span>

      <button
        class="btn-cerrar-pedido"
        (click)="cerrarPedido()"
        [disabled]="itemsPedido.length === 0">
        {{ itemsPedido.length === 0 ? 'Agrega items' : 'Cerrar pedido' }}
      </button>
    </footer>

  </div>

</div>



    
      
     
